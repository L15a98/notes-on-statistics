<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Solutions for Chapter 5 | Notes on and Solutions for Statistical Rethinking</title>
  <meta name="description" content="Notes and exercise solutions for Statistical Rethinking book." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Solutions for Chapter 5 | Notes on and Solutions for Statistical Rethinking" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes and exercise solutions for Statistical Rethinking book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Solutions for Chapter 5 | Notes on and Solutions for Statistical Rethinking" />
  
  <meta name="twitter:description" content="Notes and exercise solutions for Statistical Rethinking book." />
  

<meta name="author" content="Alexander Pastukhov" />


<meta name="date" content="2021-01-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="solutions-for-chapter-4.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes on Statistical Rethinking</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Precis</a></li>
<li class="chapter" data-level="2" data-path="loss-functions.html"><a href="loss-functions.html"><i class="fa fa-check"></i><b>2</b> Loss functions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="loss-functions.html"><a href="loss-functions.html#loss-function-the-concept"><i class="fa fa-check"></i><b>2.1</b> Loss function, the concept</a></li>
<li class="chapter" data-level="2.2" data-path="loss-functions.html"><a href="loss-functions.html#l0-mode"><i class="fa fa-check"></i><b>2.2</b> L0 (mode)</a></li>
<li class="chapter" data-level="2.3" data-path="loss-functions.html"><a href="loss-functions.html#l1-median"><i class="fa fa-check"></i><b>2.3</b> L1 (median)</a></li>
<li class="chapter" data-level="2.4" data-path="loss-functions.html"><a href="loss-functions.html#l2-mean"><i class="fa fa-check"></i><b>2.4</b> L2 (mean)</a></li>
<li class="chapter" data-level="2.5" data-path="loss-functions.html"><a href="loss-functions.html#l1-median-vs.-l2-mean"><i class="fa fa-check"></i><b>2.5</b> L1 (median) vs.Â L2 (mean)</a></li>
<li class="chapter" data-level="2.6" data-path="loss-functions.html"><a href="loss-functions.html#choosing-a-likelihood"><i class="fa fa-check"></i><b>2.6</b> Choosing a likelihood</a></li>
<li class="chapter" data-level="2.7" data-path="loss-functions.html"><a href="loss-functions.html#gaussian-in-frenquentist-versus-bayesian-statistics"><i class="fa fa-check"></i><b>2.7</b> Gaussian in frenquentist versus Bayesian statistics</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="directed-acyclic-graphs-and-causal-reasoning.html"><a href="directed-acyclic-graphs-and-causal-reasoning.html"><i class="fa fa-check"></i><b>3</b> Directed Acyclic Graphs and Causal Reasoning</a>
<ul>
<li class="chapter" data-level="3.1" data-path="directed-acyclic-graphs-and-causal-reasoning.html"><a href="directed-acyclic-graphs-and-causal-reasoning.html#peering-into-a-black-box"><i class="fa fa-check"></i><b>3.1</b> Peering into a black box</a></li>
<li class="chapter" data-level="3.2" data-path="directed-acyclic-graphs-and-causal-reasoning.html"><a href="directed-acyclic-graphs-and-causal-reasoning.html#turning-unconditional-dependence-into-conditional-independence"><i class="fa fa-check"></i><b>3.2</b> Turning unconditional dependence into conditional independence</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="collider-bias.html"><a href="collider-bias.html"><i class="fa fa-check"></i><b>4</b> Collider bias</a>
<ul>
<li class="chapter" data-level="4.1" data-path="collider-bias.html"><a href="collider-bias.html#multicollinearity"><i class="fa fa-check"></i><b>4.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="4.2" data-path="collider-bias.html"><a href="collider-bias.html#back-to-spurious-association"><i class="fa fa-check"></i><b>4.2</b> Back to spurious association</a></li>
<li class="chapter" data-level="4.3" data-path="collider-bias.html"><a href="collider-bias.html#chain-dag"><i class="fa fa-check"></i><b>4.3</b> Chain DAG</a></li>
<li class="chapter" data-level="4.4" data-path="collider-bias.html"><a href="collider-bias.html#take-home-message"><i class="fa fa-check"></i><b>4.4</b> Take-home message</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-haunted-dag.html"><a href="the-haunted-dag.html"><i class="fa fa-check"></i><b>5</b> The haunted DAG</a></li>
<li class="chapter" data-level="6" data-path="solutions-for-chapter-2.html"><a href="solutions-for-chapter-2.html"><i class="fa fa-check"></i><b>6</b> Solutions for Chapter 2</a></li>
<li class="chapter" data-level="7" data-path="solutions-for-chapter-3.html"><a href="solutions-for-chapter-3.html"><i class="fa fa-check"></i><b>7</b> Solutions for Chapter 3</a></li>
<li class="chapter" data-level="8" data-path="solutions-for-chapter-4.html"><a href="solutions-for-chapter-4.html"><i class="fa fa-check"></i><b>8</b> Solutions for Chapter 4</a></li>
<li class="chapter" data-level="9" data-path="solutions-for-chapter-5.html"><a href="solutions-for-chapter-5.html"><i class="fa fa-check"></i><b>9</b> Solutions for Chapter 5</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes on and Solutions for Statistical Rethinking</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solutions-for-chapter-5" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Solutions for Chapter 5</h1>
<div id="e1-3" class="section level4 unnumbered" number="">
<h4>5E1</h4>
<p>Which of the linear models below are multiple linear regressions?</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(Âµ_i = Î± + Î² \cdot x_i\)</span> Fits single variable <span class="math inline">\(x_i\)</span></li>
<li><span class="math inline">\(Âµ_i = Î²_x \cdot x_i + Î²_z \cdot z_i\)</span> <strong>â</strong></li>
<li><span class="math inline">\(Âµ_i = Î± + Î²(x_i â z_i)\)</span> Fits single variable, which is <em>difference</em> between <span class="math inline">\(x\)</span> and <span class="math inline">\(z\)</span>.</li>
<li><span class="math inline">\(Âµ_i = Î± + Î²_x \cdot x_i + Î²_z \cdot z\)</span> Fits single variable <span class="math inline">\(x\)</span> plus a <em>constant</em> <span class="math inline">\(z\)</span>, which simply is an offset of an intercept.</li>
</ol>
</div>
<div id="e2-3" class="section level4 unnumbered" number="">
<h4>5E2</h4>
<p>Write down a multiple regression to evaluate the claim: <em>Animal diversity is linearly related to latitude, but only after controlling for plant diversity</em>. You just need to write down the model definition.</p>
<p>I skip likelihood and priors.
<span class="math display">\[Diversity_i = Î± + Î²_{lat} \cdot Lat_i + Î²_{plant} \cdot Plant_i\]</span></p>
</div>
<div id="e3-3" class="section level4 unnumbered" number="">
<h4>5E3</h4>
<p>Write down a multiple regression to evaluate the claim: <em>Neither amount of funding nor size of laboratory is by itself a good predictor of time to PhD degree; but together these variables are both positively associated with time to degree</em>. Write down the model definition and indicate which side of zero each slope parameter should be on.</p>
<p>Again, no likelihood or priors for simplicity.
<span class="math display">\[Time_i = \alpha + \beta_F \cdot Funding_i + \beta_S \cdot Size_i\]</span>
Both variables are <em>positively associated</em> so both slopes should be positive.</p>
</div>
<div id="e4-3" class="section level4 unnumbered" number="">
<h4>5E4</h4>
<p>Suppose you have a single categorical predictor with 4 levels (unique values), labeled A, B, C and D. Let <span class="math inline">\(A_i\)</span> be an indicator variable that is 1 where case <em>i</em> is in category A. Also suppose <span class="math inline">\(B_i\)</span>, <span class="math inline">\(C_i\)</span>, and <span class="math inline">\(D_i\)</span> for the other categories. Now which of the following linear models are inferentially equivalent ways to include the categorical variable in a regression? Models are inferentially equivalent when itâs possible to compute one posterior distribution from the posterior distribution of another model.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(Âµ_i = Î± + Î²_A A_i + Î²_B B_i + Î²_D D_i\)</span></li>
<li><span class="math inline">\(Âµ_i = Î± + Î²_A A_i + Î²_B B_i + Î²_C C_i + Î²_D D_i\)</span></li>
<li><span class="math inline">\(Âµ_i = Î± + Î²_B B_i + Î²_C C_i + Î²_D D_i\)</span></li>
<li><span class="math inline">\(Âµ_i = Î±_A A_i + Î±_B B_i + Î±_C C_i + Î±_D D_i\)</span></li>
<li><span class="math inline">\(Âµ_i = Î±_A(1 â B_i â C_i â D_i) + Î±_B B_i + Î±_C C_i + Î±_D D_i\)</span></li>
</ol>
<p>Inferentially equivalent:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(Î±\)</span> codes for baseline condition <span class="math inline">\(C\)</span>, all other intercepts can be computed as <span class="math inline">\(Î± +Î²\)</span> coefficients.</p></li>
<li><p><span class="math inline">\(Î±\)</span> codes for baseline condition <span class="math inline">\(A\)</span>, all other intercepts can be computed as <span class="math inline">\(Î± +Î²\)</span> coefficients.</p></li>
<li><p>All conditions are modeled explicitly as intercepts.</p></li>
<li><p><span class="math inline">\(Î±_A(1 â B_i â C_i â D_i) + Î±_B B_i + Î±_C C_i + Î±_D D_i\)</span> then rearranged gives <span class="math inline">\(Î±_A + (Î±_B-Î±_A) B_i + (Î±_C-Î±_A) C_i + (Î±_D-Î±_A) D_i\)</span>, as <span class="math inline">\(Î±_B-Î±_A = Î²_B\)</span>, we can rewrite and see that it is identical to #3: <span class="math inline">\(Î±_A + Î²_B B_i + Î²_C C_i + Î²_D D_i\)</span></p></li>
</ol>
<p>Different model:</p>
<ol start="2" style="list-style-type: decimal">
<li>It is overdetermined, as there more parameters (five, including the intercept <span class="math inline">\(Î±\)</span>) than variables (four).</li>
</ol>
</div>
<div id="m1-3" class="section level4 unnumbered" number="">
<h4>5M1</h4>
<p>Invent your own example of a spurious correlation. An outcome variable should be correlated with both predictor variables. But when both predictors are entered in the same model, the correlation between the outcome and one of the predictors should mostly vanish (or at least be greatly reduced).</p>
<p><strong>Answer:</strong> Why invent, if there is a whole website just for that: <a href="https://tylervigen.com/spurious-correlations">tylervigen.com/spurious-correlations</a>.</p>
</div>
<div id="m2-3" class="section level4 unnumbered" number="">
<h4>5M2</h4>
<p>Invent your own example of a masked relationship. An outcome variable should be correlated with both predictor variables, but in opposite directions. And the two predictor variables should be correlated with one another.</p>
<p><strong>Answer: coffee consumption increases productivity but reduces amount of sleep that, in turn, reduces productivity.</strong></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="solutions-for-chapter-5.html#cb70-1"></a><span class="kw">set.seed</span>(<span class="dv">142397</span>)</span>
<span id="cb70-2"><a href="solutions-for-chapter-5.html#cb70-2"></a>N &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb70-3"><a href="solutions-for-chapter-5.html#cb70-3"></a>rho &lt;-<span class="st"> </span><span class="fl">0.7</span></span>
<span id="cb70-4"><a href="solutions-for-chapter-5.html#cb70-4"></a></span>
<span id="cb70-5"><a href="solutions-for-chapter-5.html#cb70-5"></a>work &lt;-<span class="st"> </span></span>
<span id="cb70-6"><a href="solutions-for-chapter-5.html#cb70-6"></a><span class="st">  </span><span class="kw">data.frame</span>(<span class="dt">Coffee =</span> <span class="kw">rnorm</span>(N, <span class="dv">5</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb70-7"><a href="solutions-for-chapter-5.html#cb70-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ActiveDuringNight =</span> <span class="kw">rnorm</span>(N, Coffee <span class="op">*</span><span class="st"> </span>rho, <span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>rho<span class="op">^</span><span class="dv">2</span>)),</span>
<span id="cb70-8"><a href="solutions-for-chapter-5.html#cb70-8"></a>         <span class="dt">Productivity =</span> <span class="kw">rnorm</span>(N, Coffee <span class="op">-</span><span class="st"> </span>ActiveDuringNight))</span>
<span id="cb70-9"><a href="solutions-for-chapter-5.html#cb70-9"></a></span>
<span id="cb70-10"><a href="solutions-for-chapter-5.html#cb70-10"></a><span class="kw">ggplot</span>(work, <span class="kw">aes</span>(<span class="dt">x=</span>Coffee, <span class="dt">y=</span>Productivity, <span class="dt">color=</span>ActiveDuringNight)) <span class="op">+</span></span>
<span id="cb70-11"><a href="solutions-for-chapter-5.html#cb70-11"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-12"><a href="solutions-for-chapter-5.html#cb70-12"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">formula=</span>y<span class="op">~</span>x)</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/5M2-1.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="solutions-for-chapter-5.html#cb71-1"></a>coffee_only_fit &lt;-<span class="st"> </span>rethinking<span class="op">::</span><span class="kw">quap</span>(</span>
<span id="cb71-2"><a href="solutions-for-chapter-5.html#cb71-2"></a>  <span class="kw">alist</span>(</span>
<span id="cb71-3"><a href="solutions-for-chapter-5.html#cb71-3"></a>    Productivity <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu, sigma), </span>
<span id="cb71-4"><a href="solutions-for-chapter-5.html#cb71-4"></a>    mu &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>bCoffee<span class="op">*</span>Coffee, </span>
<span id="cb71-5"><a href="solutions-for-chapter-5.html#cb71-5"></a>    a <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb71-6"><a href="solutions-for-chapter-5.html#cb71-6"></a>    bCoffee <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb71-7"><a href="solutions-for-chapter-5.html#cb71-7"></a>    sigma <span class="op">~</span><span class="st"> </span><span class="kw">dexp</span>(<span class="dv">1</span>)), </span>
<span id="cb71-8"><a href="solutions-for-chapter-5.html#cb71-8"></a>  <span class="dt">data =</span> work)</span>
<span id="cb71-9"><a href="solutions-for-chapter-5.html#cb71-9"></a></span>
<span id="cb71-10"><a href="solutions-for-chapter-5.html#cb71-10"></a>active_only_fit &lt;-<span class="st"> </span>rethinking<span class="op">::</span><span class="kw">quap</span>(</span>
<span id="cb71-11"><a href="solutions-for-chapter-5.html#cb71-11"></a>  <span class="kw">alist</span>(</span>
<span id="cb71-12"><a href="solutions-for-chapter-5.html#cb71-12"></a>    Productivity <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu, sigma), </span>
<span id="cb71-13"><a href="solutions-for-chapter-5.html#cb71-13"></a>    mu &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>bActive<span class="op">*</span>ActiveDuringNight, </span>
<span id="cb71-14"><a href="solutions-for-chapter-5.html#cb71-14"></a>    a <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb71-15"><a href="solutions-for-chapter-5.html#cb71-15"></a>    bActive <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb71-16"><a href="solutions-for-chapter-5.html#cb71-16"></a>    sigma <span class="op">~</span><span class="st"> </span><span class="kw">dexp</span>(<span class="dv">1</span>)), </span>
<span id="cb71-17"><a href="solutions-for-chapter-5.html#cb71-17"></a>  <span class="dt">data =</span> work)</span>
<span id="cb71-18"><a href="solutions-for-chapter-5.html#cb71-18"></a></span>
<span id="cb71-19"><a href="solutions-for-chapter-5.html#cb71-19"></a></span>
<span id="cb71-20"><a href="solutions-for-chapter-5.html#cb71-20"></a>work_fit &lt;-<span class="st"> </span>rethinking<span class="op">::</span><span class="kw">quap</span>(</span>
<span id="cb71-21"><a href="solutions-for-chapter-5.html#cb71-21"></a>  <span class="kw">alist</span>(</span>
<span id="cb71-22"><a href="solutions-for-chapter-5.html#cb71-22"></a>    Productivity <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu, sigma), </span>
<span id="cb71-23"><a href="solutions-for-chapter-5.html#cb71-23"></a>    mu &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>bCoffee<span class="op">*</span>Coffee <span class="op">+</span><span class="st"> </span>bActive<span class="op">*</span>ActiveDuringNight, </span>
<span id="cb71-24"><a href="solutions-for-chapter-5.html#cb71-24"></a>    a <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb71-25"><a href="solutions-for-chapter-5.html#cb71-25"></a>    bCoffee <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb71-26"><a href="solutions-for-chapter-5.html#cb71-26"></a>    bActive <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb71-27"><a href="solutions-for-chapter-5.html#cb71-27"></a>    sigma <span class="op">~</span><span class="st"> </span><span class="kw">dexp</span>(<span class="dv">1</span>)), </span>
<span id="cb71-28"><a href="solutions-for-chapter-5.html#cb71-28"></a>  <span class="dt">data =</span> work)</span>
<span id="cb71-29"><a href="solutions-for-chapter-5.html#cb71-29"></a></span>
<span id="cb71-30"><a href="solutions-for-chapter-5.html#cb71-30"></a></span>
<span id="cb71-31"><a href="solutions-for-chapter-5.html#cb71-31"></a><span class="kw">precis</span>(work_fit)</span></code></pre></div>
<pre><code>##               mean         sd       5.5%      94.5%
## a        0.1696173 0.52881231 -0.6755269  1.0147615
## bCoffee  0.9302926 0.13805381  0.7096560  1.1509293
## bActive -0.9716076 0.12270282 -1.1677104 -0.7755048
## sigma    0.9666352 0.06789557  0.8581250  1.0751454</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="solutions-for-chapter-5.html#cb73-1"></a><span class="co"># plot(coeftab(coffee_only_fit, active_only_fit, work_fit) , pars=c(&quot;bCoffee&quot;,&quot;bActive&quot;) )</span></span></code></pre></div>
</div>
<div id="m3-3" class="section level4 unnumbered" number="">
<h4>5M3</h4>
<p>It is sometimes observed that the best predictor of fire risk is the presence of firefighters â States and localities with many firefighters also have more fires. Presumably firefighters do not cause fires. Nevertheless, this is not a spurious correlation. Instead fires cause firefighters. Consider the same reversal of causal inference in the context of the divorce and marriage data. How might a high divorce rate cause a higher marriage rate? Can you think of a way to evaluate this relationship, using multiple regression?</p>
<p><strong>Answer:</strong> Higher divorce rate means more adults that can re-marry, raising the marriage rate. We can evaluate this by reversing the presumed causal relationship with marriage rate becoming the outcome variable and divorce rate (and median marriage age) being predictors.</p>
<p><img src="notes-on-statistical-rethinking_files/figure-html/5M3-dags-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="m4-3" class="section level4 unnumbered" number="">
<h4>5M4</h4>
<p>In the divorce data, States with high numbers of members of the Church of Jesus Christ of Latter-day Saints (LDS) have much lower divorce rates than the regression models expected. Find a list of LDS population by State and use those numbers as a predictor variable, predicting divorce rate
using marriage rate, median age at marriage, and percent LDS population (possibly standardized). You may want to consider transformations of the raw percent LDS variable.</p>
<p><strong>Answer:</strong> I used data supplied by <a href="https://en.wikipedia.org/wiki/The_Church_of_Jesus_Christ_of_Latter-day_Saints_membership_statistics_(United_States)">Wikipedia</a>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="solutions-for-chapter-5.html#cb74-1"></a><span class="co"># adding percentage information to the table</span></span>
<span id="cb74-2"><a href="solutions-for-chapter-5.html#cb74-2"></a><span class="kw">data</span>(<span class="st">&quot;WaffleDivorce&quot;</span>)</span>
<span id="cb74-3"><a href="solutions-for-chapter-5.html#cb74-3"></a>waffles &lt;-<span class="st"> </span></span>
<span id="cb74-4"><a href="solutions-for-chapter-5.html#cb74-4"></a><span class="st">  </span>WaffleDivorce <span class="op">%&gt;%</span></span>
<span id="cb74-5"><a href="solutions-for-chapter-5.html#cb74-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Location =</span> <span class="kw">as.character</span>(Location),</span>
<span id="cb74-6"><a href="solutions-for-chapter-5.html#cb74-6"></a>         <span class="dt">D =</span> <span class="kw">standardize</span>(Divorce),</span>
<span id="cb74-7"><a href="solutions-for-chapter-5.html#cb74-7"></a>         <span class="dt">M =</span> <span class="kw">standardize</span>(Marriage),</span>
<span id="cb74-8"><a href="solutions-for-chapter-5.html#cb74-8"></a>         <span class="dt">A =</span> <span class="kw">standardize</span>(MedianAgeMarriage))</span>
<span id="cb74-9"><a href="solutions-for-chapter-5.html#cb74-9"></a></span>
<span id="cb74-10"><a href="solutions-for-chapter-5.html#cb74-10"></a>lds &lt;-<span class="st"> </span></span>
<span id="cb74-11"><a href="solutions-for-chapter-5.html#cb74-11"></a><span class="st">  </span><span class="kw">read_excel</span>(<span class="st">&quot;data/LDS.xlsx&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb74-12"><a href="solutions-for-chapter-5.html#cb74-12"></a><span class="st">  </span><span class="kw">select</span>(State, LDS) <span class="op">%&gt;%</span></span>
<span id="cb74-13"><a href="solutions-for-chapter-5.html#cb74-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">zLDS =</span> <span class="kw">c</span>(<span class="kw">scale</span>(LDS)))</span>
<span id="cb74-14"><a href="solutions-for-chapter-5.html#cb74-14"></a>waffles_lds &lt;-<span class="st"> </span><span class="kw">left_join</span>(waffles, lds, <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;Location&quot;</span> =<span class="st"> &quot;State&quot;</span>))</span>
<span id="cb74-15"><a href="solutions-for-chapter-5.html#cb74-15"></a></span>
<span id="cb74-16"><a href="solutions-for-chapter-5.html#cb74-16"></a></span>
<span id="cb74-17"><a href="solutions-for-chapter-5.html#cb74-17"></a>lds_fit &lt;-<span class="st"> </span><span class="kw">quap</span>(</span>
<span id="cb74-18"><a href="solutions-for-chapter-5.html#cb74-18"></a>  <span class="kw">alist</span>(</span>
<span id="cb74-19"><a href="solutions-for-chapter-5.html#cb74-19"></a>    D <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu, sigma),</span>
<span id="cb74-20"><a href="solutions-for-chapter-5.html#cb74-20"></a>    mu &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>bM<span class="op">*</span>M <span class="op">+</span><span class="st"> </span>bA<span class="op">*</span>A <span class="op">+</span><span class="st"> </span>bLDS <span class="op">*</span><span class="st"> </span>zLDS,</span>
<span id="cb74-21"><a href="solutions-for-chapter-5.html#cb74-21"></a>    a <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb74-22"><a href="solutions-for-chapter-5.html#cb74-22"></a>    bM <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb74-23"><a href="solutions-for-chapter-5.html#cb74-23"></a>    bA <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb74-24"><a href="solutions-for-chapter-5.html#cb74-24"></a>    bLDS <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb74-25"><a href="solutions-for-chapter-5.html#cb74-25"></a>    sigma <span class="op">~</span><span class="st"> </span><span class="kw">dexp</span>(<span class="dv">1</span>)), </span>
<span id="cb74-26"><a href="solutions-for-chapter-5.html#cb74-26"></a>  <span class="dt">data =</span> waffles_lds)</span>
<span id="cb74-27"><a href="solutions-for-chapter-5.html#cb74-27"></a></span>
<span id="cb74-28"><a href="solutions-for-chapter-5.html#cb74-28"></a><span class="kw">precis</span>(lds_fit)</span></code></pre></div>
<pre><code>##               mean         sd       5.5%      94.5%
## a     -0.001287808 0.09189733 -0.1481575  0.1455819
## bM     0.037721186 0.14749863 -0.1980101  0.2734525
## bA    -0.689164567 0.14428375 -0.9197579 -0.4585713
## bLDS  -0.312889876 0.11857497 -0.5023956 -0.1233842
## sigma  0.731605049 0.07264332  0.6155070  0.8477031</code></pre>
</div>
<div id="m5-3" class="section level4 unnumbered" number="">
<h4>5M5</h4>
<p>One way to reason through multiple causation hypotheses is to imagine detailed mechanisms through which predictor variables may influence outcomes. For example, it is sometimes argued that the price of gasoline (predictor variable) is positively associated with lower obesity rates (outcome variable). However, there are at least two important mechanisms by which the price of gas could reduce obesity. First, it could lead to less driving and therefore more exercise. Second, it could lead to less driving, which leads to less eating out, which leads to less consumption of huge restaurant meals. Can you outline one or more multiple regressions that address these two mechanisms? Assume you can have any predictor data you need.</p>
<p><span class="math display">\[Weight = \alpha + \beta_{Gasoline} Gasoline + \beta_{Driving} Driving + \beta_{Eating} Eating\]</span>
Here, if both driving and eating out are fully caused by the gasoline price (so, we can assume that <span class="math inline">\(Driving = \beta_DG Gasoline + \epsilon\)</span>, same for eating out), we would expect multple regression to put higher weight on <span class="math inline">\(\beta_{Gasoline}\)</span> than to caused variables.</p>
</div>
<div id="h1-3" class="section level4 unnumbered" number="">
<h4>5H1</h4>
<p>In the divorce example, suppose the DAG is: M â A â D. What are the implied conditional independencies of the graph? Are the data consistent with it?</p>
<p><strong>Answer: </strong> This is a chain, so <em>marriage</em> and <em>divorce</em> rate are independent conditional on <em>age</em>. Data <em>is</em> compatible with this causal model.</p>
</div>
<div id="h2-3" class="section level4 unnumbered" number="">
<h4>5H2</h4>
<p>Assuming that the DAG for the divorce example is indeed M â A â D, fit a new model and use it to estimate the counterfactual effect of halving a Stateâs marriage rate M. Use the counterfactual example from the chapter (starting on page 140) as a template.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="solutions-for-chapter-5.html#cb76-1"></a><span class="kw">data</span>(WaffleDivorce)</span>
<span id="cb76-2"><a href="solutions-for-chapter-5.html#cb76-2"></a>d &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb76-3"><a href="solutions-for-chapter-5.html#cb76-3"></a>d<span class="op">$</span>A &lt;-<span class="st"> </span><span class="kw">standardize</span>(WaffleDivorce<span class="op">$</span>MedianAgeMarriage)</span>
<span id="cb76-4"><a href="solutions-for-chapter-5.html#cb76-4"></a>d<span class="op">$</span>D &lt;-<span class="st"> </span><span class="kw">standardize</span>(WaffleDivorce<span class="op">$</span>Divorce)</span>
<span id="cb76-5"><a href="solutions-for-chapter-5.html#cb76-5"></a>d<span class="op">$</span>M &lt;-<span class="st"> </span><span class="kw">standardize</span>(WaffleDivorce<span class="op">$</span>Marriage)</span>
<span id="cb76-6"><a href="solutions-for-chapter-5.html#cb76-6"></a>d<span class="op">$</span>halfM &lt;-<span class="st"> </span>((d<span class="op">$</span>M <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)  <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(WaffleDivorce<span class="op">$</span>Marriage)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(WaffleDivorce<span class="op">$</span>Marriage)</span>
<span id="cb76-7"><a href="solutions-for-chapter-5.html#cb76-7"></a></span>
<span id="cb76-8"><a href="solutions-for-chapter-5.html#cb76-8"></a>MAD_fit &lt;-<span class="st"> </span><span class="kw">quap</span>(</span>
<span id="cb76-9"><a href="solutions-for-chapter-5.html#cb76-9"></a>  <span class="kw">alist</span>(</span>
<span id="cb76-10"><a href="solutions-for-chapter-5.html#cb76-10"></a>    <span class="co">## M -&gt; A -&gt; D</span></span>
<span id="cb76-11"><a href="solutions-for-chapter-5.html#cb76-11"></a>    D <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu, sigma),</span>
<span id="cb76-12"><a href="solutions-for-chapter-5.html#cb76-12"></a>    mu &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>bA<span class="op">*</span>A,</span>
<span id="cb76-13"><a href="solutions-for-chapter-5.html#cb76-13"></a>    a <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb76-14"><a href="solutions-for-chapter-5.html#cb76-14"></a>    bA <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb76-15"><a href="solutions-for-chapter-5.html#cb76-15"></a>    sigma <span class="op">~</span><span class="st"> </span><span class="kw">dexp</span>(<span class="dv">1</span>),</span>
<span id="cb76-16"><a href="solutions-for-chapter-5.html#cb76-16"></a>    </span>
<span id="cb76-17"><a href="solutions-for-chapter-5.html#cb76-17"></a>    <span class="co">## M -&gt; A</span></span>
<span id="cb76-18"><a href="solutions-for-chapter-5.html#cb76-18"></a>    A <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu_A, sigma_A),</span>
<span id="cb76-19"><a href="solutions-for-chapter-5.html#cb76-19"></a>    mu_A &lt;-<span class="st"> </span>aA <span class="op">+</span><span class="st"> </span>bMA<span class="op">*</span>M,</span>
<span id="cb76-20"><a href="solutions-for-chapter-5.html#cb76-20"></a>    aA <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb76-21"><a href="solutions-for-chapter-5.html#cb76-21"></a>    bMA <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb76-22"><a href="solutions-for-chapter-5.html#cb76-22"></a>    sigma_A <span class="op">~</span><span class="st"> </span><span class="kw">dexp</span>(<span class="dv">1</span>)),</span>
<span id="cb76-23"><a href="solutions-for-chapter-5.html#cb76-23"></a>  <span class="dt">data =</span> d)</span>
<span id="cb76-24"><a href="solutions-for-chapter-5.html#cb76-24"></a></span>
<span id="cb76-25"><a href="solutions-for-chapter-5.html#cb76-25"></a><span class="kw">precis</span>(MAD_fit)</span></code></pre></div>
<pre><code>##                  mean         sd       5.5%      94.5%
## a       -2.447373e-06 0.09737992 -0.1556344  0.1556295
## bA      -5.683983e-01 0.11000148 -0.7442019 -0.3925947
## sigma    7.883380e-01 0.07801437  0.6636559  0.9130200
## aA       6.352864e-05 0.08686271 -0.1387599  0.1388869
## bMA     -6.947393e-01 0.09574640 -0.8477605 -0.5417180
## sigma_A  6.818807e-01 0.06761558  0.5738180  0.7899435</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="solutions-for-chapter-5.html#cb78-1"></a>sim_dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">M=</span><span class="kw">sort</span>(d<span class="op">$</span>M))</span>
<span id="cb78-2"><a href="solutions-for-chapter-5.html#cb78-2"></a>simulations &lt;-<span class="st"> </span><span class="kw">sim</span>(MAD_fit , <span class="dt">data=</span>sim_dat, <span class="dt">vars=</span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>))</span>
<span id="cb78-3"><a href="solutions-for-chapter-5.html#cb78-3"></a><span class="kw">plot</span>(sim_dat<span class="op">$</span>M , <span class="kw">colMeans</span>(simulations<span class="op">$</span>D) , <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">2</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">3</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span> ,</span>
<span id="cb78-4"><a href="solutions-for-chapter-5.html#cb78-4"></a><span class="dt">xlab=</span><span class="st">&quot;manipulated M&quot;</span> , <span class="dt">ylab=</span><span class="st">&quot;counterfactual D&quot;</span> )</span>
<span id="cb78-5"><a href="solutions-for-chapter-5.html#cb78-5"></a><span class="kw">shade</span>( <span class="kw">apply</span>(simulations<span class="op">$</span>D, <span class="dv">2</span>, PI) , sim_dat<span class="op">$</span>M)</span>
<span id="cb78-6"><a href="solutions-for-chapter-5.html#cb78-6"></a><span class="kw">mtext</span>( <span class="st">&quot;Original effect of M on D&quot;</span> )</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/5H2-1.png" width="672" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="solutions-for-chapter-5.html#cb79-1"></a>sim_dat2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">M=</span><span class="kw">sort</span>(d<span class="op">$</span>halfM))</span>
<span id="cb79-2"><a href="solutions-for-chapter-5.html#cb79-2"></a>simulations2 &lt;-<span class="st"> </span><span class="kw">sim</span>(MAD_fit , <span class="dt">data=</span>sim_dat2, <span class="dt">vars=</span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>))</span>
<span id="cb79-3"><a href="solutions-for-chapter-5.html#cb79-3"></a><span class="kw">plot</span>(sim_dat2<span class="op">$</span>M , <span class="kw">colMeans</span>(simulations2<span class="op">$</span>D) , <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">2</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">3</span>), <span class="dt">type=</span><span class="st">&quot;l&quot;</span> ,</span>
<span id="cb79-4"><a href="solutions-for-chapter-5.html#cb79-4"></a><span class="dt">xlab=</span><span class="st">&quot;manipulated M&quot;</span> , <span class="dt">ylab=</span><span class="st">&quot;counterfactual D&quot;</span> )</span>
<span id="cb79-5"><a href="solutions-for-chapter-5.html#cb79-5"></a><span class="kw">shade</span>( <span class="kw">apply</span>(simulations2<span class="op">$</span>D, <span class="dv">2</span>, PI) , sim_dat2<span class="op">$</span>M)</span>
<span id="cb79-6"><a href="solutions-for-chapter-5.html#cb79-6"></a><span class="kw">mtext</span>( <span class="st">&quot;Total counterfactual effect of halving M on D&quot;</span>)</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/5H2-2.png" width="672" /></p>
</div>
<div id="h3-3" class="section level4 unnumbered" number="">
<h4>5H3</h4>
<p>Return to the milk energy model, m5.7. Suppose that the true causal relationship among the variables is:</p>
<p><img src="notes-on-statistical-rethinking_files/figure-html/5H3-dags-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now compute the counterfactual effect on K of doubling M. You will need to account for both the direct and indirect paths of causation. Use the counterfactual example from the chapter (starting on page 140) as a template.</p>
</div>
<div id="h4-3" class="section level4 unnumbered" number="">
<h4>5H4</h4>
<p>Here is an open practice problem to engage your imagination. In the divorce date, States in the southern United States have many of the highest divorce rates. Add the South indicator variable to the analysis. First, draw one or more DAGs that represent your ideas for how Southern American culture might influence any of the other three variables (D, M or A). Then list the testable implications of your DAGs, if there are any, and fit one or more models to evaluate the implications. What do you think the influence of âSouthernessâ is?</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="solutions-for-chapter-5.html#cb80-1"></a>southern_states &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Alabama&quot;</span>, <span class="st">&quot;Arkansas&quot;</span>, <span class="st">&quot;Delaware&quot;</span>, <span class="st">&quot;Florida&quot;</span>, <span class="st">&quot;Georgia&quot;</span>, <span class="st">&quot;Kentucky&quot;</span>, <span class="st">&quot;Louisiana&quot;</span>, <span class="st">&quot;Maryland&quot;</span>, <span class="st">&quot;Mississippi&quot;</span>, <span class="st">&quot;North Carolina&quot;</span>, <span class="st">&quot;Oklahoma&quot;</span>, <span class="st">&quot;South Carolina&quot;</span>, <span class="st">&quot;Tennessee&quot;</span>, <span class="st">&quot;Texas&quot;</span>, <span class="st">&quot;Virginia&quot;</span>, <span class="st">&quot;West Virginia&quot;</span>)</span>
<span id="cb80-2"><a href="solutions-for-chapter-5.html#cb80-2"></a></span>
<span id="cb80-3"><a href="solutions-for-chapter-5.html#cb80-3"></a><span class="kw">data</span>(WaffleDivorce)</span>
<span id="cb80-4"><a href="solutions-for-chapter-5.html#cb80-4"></a>waffles &lt;-<span class="st"> </span></span>
<span id="cb80-5"><a href="solutions-for-chapter-5.html#cb80-5"></a><span class="st">  </span>WaffleDivorce <span class="op">%&gt;%</span></span>
<span id="cb80-6"><a href="solutions-for-chapter-5.html#cb80-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">IsSouthern =</span> Location <span class="op">%in%</span><span class="st"> </span>southern_states)</span>
<span id="cb80-7"><a href="solutions-for-chapter-5.html#cb80-7"></a></span>
<span id="cb80-8"><a href="solutions-for-chapter-5.html#cb80-8"></a>MD_plot &lt;-<span class="st"> </span></span>
<span id="cb80-9"><a href="solutions-for-chapter-5.html#cb80-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>waffles, <span class="kw">aes</span>(<span class="dt">x=</span>Marriage, <span class="dt">y=</span>Divorce, <span class="dt">color=</span>IsSouthern)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-10"><a href="solutions-for-chapter-5.html#cb80-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">formula=</span>y<span class="op">~</span>x, <span class="dt">se=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-11"><a href="solutions-for-chapter-5.html#cb80-11"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-12"><a href="solutions-for-chapter-5.html#cb80-12"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Marriage rate&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-13"><a href="solutions-for-chapter-5.html#cb80-13"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Divorce rate&quot;</span>)</span>
<span id="cb80-14"><a href="solutions-for-chapter-5.html#cb80-14"></a></span>
<span id="cb80-15"><a href="solutions-for-chapter-5.html#cb80-15"></a>AD_plot &lt;-<span class="st"> </span></span>
<span id="cb80-16"><a href="solutions-for-chapter-5.html#cb80-16"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>waffles, <span class="kw">aes</span>(<span class="dt">x=</span>MedianAgeMarriage, <span class="dt">y=</span>Divorce, <span class="dt">color=</span>IsSouthern)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-17"><a href="solutions-for-chapter-5.html#cb80-17"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">formula=</span>y<span class="op">~</span>x, <span class="dt">se=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-18"><a href="solutions-for-chapter-5.html#cb80-18"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-19"><a href="solutions-for-chapter-5.html#cb80-19"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Median age marriage&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-20"><a href="solutions-for-chapter-5.html#cb80-20"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Divorce rate&quot;</span>)</span>
<span id="cb80-21"><a href="solutions-for-chapter-5.html#cb80-21"></a></span>
<span id="cb80-22"><a href="solutions-for-chapter-5.html#cb80-22"></a>AM_plot &lt;-<span class="st"> </span></span>
<span id="cb80-23"><a href="solutions-for-chapter-5.html#cb80-23"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data=</span>waffles, <span class="kw">aes</span>(<span class="dt">x=</span>MedianAgeMarriage, <span class="dt">y=</span>Marriage, <span class="dt">color=</span>IsSouthern)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-24"><a href="solutions-for-chapter-5.html#cb80-24"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">formula=</span>y<span class="op">~</span>x, <span class="dt">se=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-25"><a href="solutions-for-chapter-5.html#cb80-25"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-26"><a href="solutions-for-chapter-5.html#cb80-26"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Median age marriage&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-27"><a href="solutions-for-chapter-5.html#cb80-27"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Marriage rate&quot;</span>)</span>
<span id="cb80-28"><a href="solutions-for-chapter-5.html#cb80-28"></a></span>
<span id="cb80-29"><a href="solutions-for-chapter-5.html#cb80-29"></a>MD_plot <span class="op">/</span><span class="st"> </span>AD_plot <span class="op">/</span><span class="st"> </span>AM_plot</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/unnamed-chunk-30-1.png" width="100%" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="solutions-for-chapter-5.html#cb81-1"></a>south_waffles &lt;-</span>
<span id="cb81-2"><a href="solutions-for-chapter-5.html#cb81-2"></a><span class="st">  </span>waffles <span class="op">%&gt;%</span></span>
<span id="cb81-3"><a href="solutions-for-chapter-5.html#cb81-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">A =</span> MedianAgeMarriage,</span>
<span id="cb81-4"><a href="solutions-for-chapter-5.html#cb81-4"></a>         <span class="dt">M =</span> Marriage,</span>
<span id="cb81-5"><a href="solutions-for-chapter-5.html#cb81-5"></a>         <span class="dt">D =</span> Divorce,</span>
<span id="cb81-6"><a href="solutions-for-chapter-5.html#cb81-6"></a>         <span class="dt">S =</span> <span class="kw">as.integer</span>(IsSouthern))</span>
<span id="cb81-7"><a href="solutions-for-chapter-5.html#cb81-7"></a></span>
<span id="cb81-8"><a href="solutions-for-chapter-5.html#cb81-8"></a>south_waffles_fit &lt;-<span class="st"> </span><span class="kw">quap</span>(</span>
<span id="cb81-9"><a href="solutions-for-chapter-5.html#cb81-9"></a>  <span class="kw">alist</span>(</span>
<span id="cb81-10"><a href="solutions-for-chapter-5.html#cb81-10"></a>    D <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu , sigma),</span>
<span id="cb81-11"><a href="solutions-for-chapter-5.html#cb81-11"></a>    mu &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>bM<span class="op">*</span>M <span class="op">+</span><span class="st"> </span>bA<span class="op">*</span>A <span class="op">+</span><span class="st"> </span>bS<span class="op">*</span>S,</span>
<span id="cb81-12"><a href="solutions-for-chapter-5.html#cb81-12"></a>    a <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb81-13"><a href="solutions-for-chapter-5.html#cb81-13"></a>    bA <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb81-14"><a href="solutions-for-chapter-5.html#cb81-14"></a>    bM <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb81-15"><a href="solutions-for-chapter-5.html#cb81-15"></a>    bS <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb81-16"><a href="solutions-for-chapter-5.html#cb81-16"></a>    sigma <span class="op">~</span><span class="st"> </span><span class="kw">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb81-17"><a href="solutions-for-chapter-5.html#cb81-17"></a>  ), </span>
<span id="cb81-18"><a href="solutions-for-chapter-5.html#cb81-18"></a>  <span class="dt">data =</span> south_waffles,</span>
<span id="cb81-19"><a href="solutions-for-chapter-5.html#cb81-19"></a>)</span>
<span id="cb81-20"><a href="solutions-for-chapter-5.html#cb81-20"></a></span>
<span id="cb81-21"><a href="solutions-for-chapter-5.html#cb81-21"></a><span class="kw">precis</span>(south_waffles_fit)</span></code></pre></div>
<pre><code>##             mean         sd       5.5%     94.5%
## a     0.01898917 0.19997902 -0.3006159 0.3385943
## bA    0.17513541 0.04075194  0.1100059 0.2402649
## bM    0.23216919 0.05230854  0.1485700 0.3157683
## bS    1.28450020 0.49893260  0.4871095 2.0818909
## sigma 1.62744047 0.15893808  1.3734267 1.8814542</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="solutions-for-chapter-5.html#cb83-1"></a>south_waffles &lt;-</span>
<span id="cb83-2"><a href="solutions-for-chapter-5.html#cb83-2"></a><span class="st">  </span>waffles <span class="op">%&gt;%</span></span>
<span id="cb83-3"><a href="solutions-for-chapter-5.html#cb83-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">A =</span> MedianAgeMarriage,</span>
<span id="cb83-4"><a href="solutions-for-chapter-5.html#cb83-4"></a>         <span class="dt">M =</span> Marriage,</span>
<span id="cb83-5"><a href="solutions-for-chapter-5.html#cb83-5"></a>         <span class="dt">D =</span> Divorce,</span>
<span id="cb83-6"><a href="solutions-for-chapter-5.html#cb83-6"></a>         <span class="dt">S =</span> <span class="kw">as.integer</span>(IsSouthern))</span>
<span id="cb83-7"><a href="solutions-for-chapter-5.html#cb83-7"></a></span>
<span id="cb83-8"><a href="solutions-for-chapter-5.html#cb83-8"></a>south_waffles_fit &lt;-<span class="st"> </span><span class="kw">quap</span>(</span>
<span id="cb83-9"><a href="solutions-for-chapter-5.html#cb83-9"></a>  <span class="kw">alist</span>(</span>
<span id="cb83-10"><a href="solutions-for-chapter-5.html#cb83-10"></a>    D <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(mu , sigma),</span>
<span id="cb83-11"><a href="solutions-for-chapter-5.html#cb83-11"></a>    mu &lt;-<span class="st"> </span>a <span class="op">+</span><span class="st"> </span>bM<span class="op">*</span>M <span class="op">+</span><span class="st"> </span>bA<span class="op">*</span>A <span class="op">+</span><span class="st"> </span>bS<span class="op">*</span>S,</span>
<span id="cb83-12"><a href="solutions-for-chapter-5.html#cb83-12"></a>    a <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb83-13"><a href="solutions-for-chapter-5.html#cb83-13"></a>    bA <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb83-14"><a href="solutions-for-chapter-5.html#cb83-14"></a>    bM <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb83-15"><a href="solutions-for-chapter-5.html#cb83-15"></a>    bS <span class="op">~</span><span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb83-16"><a href="solutions-for-chapter-5.html#cb83-16"></a>    sigma <span class="op">~</span><span class="st"> </span><span class="kw">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb83-17"><a href="solutions-for-chapter-5.html#cb83-17"></a>  ), </span>
<span id="cb83-18"><a href="solutions-for-chapter-5.html#cb83-18"></a>  <span class="dt">data =</span> south_waffles,</span>
<span id="cb83-19"><a href="solutions-for-chapter-5.html#cb83-19"></a>)</span>
<span id="cb83-20"><a href="solutions-for-chapter-5.html#cb83-20"></a></span>
<span id="cb83-21"><a href="solutions-for-chapter-5.html#cb83-21"></a><span class="kw">precis</span>(south_waffles_fit)</span></code></pre></div>
<pre><code>##             mean         sd       5.5%     94.5%
## a     0.01893565 0.19997902 -0.3006695 0.3385408
## bA    0.17513179 0.04075256  0.1100013 0.2402623
## bM    0.23217688 0.05230936  0.1485764 0.3157773
## bS    1.28442967 0.49894048  0.4870264 2.0818329
## sigma 1.62746618 0.15894419  1.3734427 1.8814897</code></pre>

</div>
</div>



















            </section>

          </div>
        </div>
      </div>
<a href="solutions-for-chapter-4.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["notes-on-statistical-rethinking.pdf", "notes-on-statistical-rethinking.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
