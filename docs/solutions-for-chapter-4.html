<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Solutions for Chapter 4 | Notes on and Solutions for Statistical Rethinking</title>
  <meta name="description" content="Notes and exercise solutions for Statistical Rethinking book." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Solutions for Chapter 4 | Notes on and Solutions for Statistical Rethinking" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes and exercise solutions for Statistical Rethinking book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Solutions for Chapter 4 | Notes on and Solutions for Statistical Rethinking" />
  
  <meta name="twitter:description" content="Notes and exercise solutions for Statistical Rethinking book." />
  

<meta name="author" content="Alexander Pastukhov" />


<meta name="date" content="2020-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="solutions-for-chapter-3.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes on Statistical Rethinking</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Precis</a></li>
<li class="chapter" data-level="2" data-path="loss-functions.html"><a href="loss-functions.html"><i class="fa fa-check"></i><b>2</b> Loss functions</a>
<ul>
<li class="chapter" data-level="2.1" data-path="loss-functions.html"><a href="loss-functions.html#loss-function-the-concept"><i class="fa fa-check"></i><b>2.1</b> Loss function, the concept</a></li>
<li class="chapter" data-level="2.2" data-path="loss-functions.html"><a href="loss-functions.html#l0-mode"><i class="fa fa-check"></i><b>2.2</b> L0 (mode)</a></li>
<li class="chapter" data-level="2.3" data-path="loss-functions.html"><a href="loss-functions.html#l1-median"><i class="fa fa-check"></i><b>2.3</b> L1 (median)</a></li>
<li class="chapter" data-level="2.4" data-path="loss-functions.html"><a href="loss-functions.html#l2-mean"><i class="fa fa-check"></i><b>2.4</b> L2 (mean)</a></li>
<li class="chapter" data-level="2.5" data-path="loss-functions.html"><a href="loss-functions.html#l1-median-vs.-l2-mean"><i class="fa fa-check"></i><b>2.5</b> L1 (median) vs.Â L2 (mean)</a></li>
<li class="chapter" data-level="2.6" data-path="loss-functions.html"><a href="loss-functions.html#choosing-a-likelihood"><i class="fa fa-check"></i><b>2.6</b> Choosing a likelihood</a></li>
<li class="chapter" data-level="2.7" data-path="loss-functions.html"><a href="loss-functions.html#gaussian-in-frenquentist-versus-bayesian-statistics"><i class="fa fa-check"></i><b>2.7</b> Gaussian in frenquentist versus Bayesian statistics</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiple-regression-and-causal-reasoning.html"><a href="multiple-regression-and-causal-reasoning.html"><i class="fa fa-check"></i><b>3</b> Multiple Regression and Causal Reasoning</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multiple-regression-and-causal-reasoning.html"><a href="multiple-regression-and-causal-reasoning.html#peering-into-a-black-box"><i class="fa fa-check"></i><b>3.1</b> Peering into a black box</a></li>
<li class="chapter" data-level="3.2" data-path="multiple-regression-and-causal-reasoning.html"><a href="multiple-regression-and-causal-reasoning.html#turning-unconditional-dependence-into-conditional-independence"><i class="fa fa-check"></i><b>3.2</b> Turning unconditional dependence into conditional independence</a></li>
<li class="chapter" data-level="3.3" data-path="multiple-regression-and-causal-reasoning.html"><a href="multiple-regression-and-causal-reasoning.html#magic-of-multiple-regression"><i class="fa fa-check"></i><b>3.3</b> Magic of multiple regression</a></li>
<li class="chapter" data-level="3.4" data-path="multiple-regression-and-causal-reasoning.html"><a href="multiple-regression-and-causal-reasoning.html#multicollinearity"><i class="fa fa-check"></i><b>3.4</b> Multicollinearity</a></li>
<li class="chapter" data-level="3.5" data-path="multiple-regression-and-causal-reasoning.html"><a href="multiple-regression-and-causal-reasoning.html#back-to-spurious-association"><i class="fa fa-check"></i><b>3.5</b> Back to spurious association</a></li>
<li class="chapter" data-level="3.6" data-path="multiple-regression-and-causal-reasoning.html"><a href="multiple-regression-and-causal-reasoning.html#warning"><i class="fa fa-check"></i><b>3.6</b> Warning</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="solutions-for-chapter-2.html"><a href="solutions-for-chapter-2.html"><i class="fa fa-check"></i><b>4</b> Solutions for Chapter 2</a></li>
<li class="chapter" data-level="5" data-path="solutions-for-chapter-3.html"><a href="solutions-for-chapter-3.html"><i class="fa fa-check"></i><b>5</b> Solutions for Chapter 3</a></li>
<li class="chapter" data-level="6" data-path="solutions-for-chapter-4.html"><a href="solutions-for-chapter-4.html"><i class="fa fa-check"></i><b>6</b> Solutions for Chapter 4</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes on and Solutions for Statistical Rethinking</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="solutions-for-chapter-4" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Solutions for Chapter 4</h1>
<div id="e1-2" class="section level4 unnumbered">
<h4>4E1</h4>
<p>In the model definition below, which line is the likelihood?
<span class="math display">\[\rightarrow ~ y_i \sim Normal(\mu, \sigma) ~ \leftarrow\\
\mu \sim Normal(0, 10) \\
\sigma \sim Exponential(1)\]</span></p>
</div>
<div id="e2-2" class="section level4 unnumbered">
<h4>4E2</h4>
<p>In the model definition just above, how many parameters are in the posterior distribution?</p>
<p>**Two: <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="e3-2" class="section level4 unnumbered">
<h4>4E3</h4>
<p>Using the model definition above, write down the appropriate form of Bayesâ theorem that includes the proper likelihood and priors.</p>
<p><span class="math display">\[
Pr(\mu, \sigma | y) = \frac{\prod_i Normal(y_i| \mu, \sigma) \cdot Normal(mu | 0, 10) \cdot Exponential(\sigma | 1)}
{\int \int \prod_i Normal(y_i| \mu, \sigma) \cdot Normal(mu | 0, 10) \cdot Exponential(\sigma | 1) \partial \mu \partial \sigma}
\]</span></p>
</div>
<div id="e4-2" class="section level4 unnumbered">
<h4>4E4</h4>
<p>In the model definition below, which line is the linear model?</p>
<p><span class="math display">\[y_i â¼ Normal(\mu, \sigma) \\
\rightarrow ~\mu_i = \alpha + \beta x_i ~\leftarrow\\
Î± â¼ Normal(0, 10) \\ 
Î² â¼ Normal(0, 1) \\
Ï â¼ Exponential(2)\]</span></p>
</div>
<div id="e5-1" class="section level4 unnumbered">
<h4>4E5</h4>
<p>In the model definition just above, how many parameters are in the posterior distribution?</p>
<p>Three, <span class="math inline">\(Î±\)</span>, <span class="math inline">\(Î²\)</span> (used to compute <span class="math inline">\(\mu\)</span>), and <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="m1-2" class="section level4 unnumbered">
<h4>4M1</h4>
<p>For the model definition below, simulate observed y values from the prior (not the posterior).</p>
<p><span class="math display">\[y_i \sim Normal(\mu,\sigma) \\
\mu \sim Normal(0, 10) \\
\sigma \sim Exponential(1)\]</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="solutions-for-chapter-4.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb38-2"><a href="solutions-for-chapter-4.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="solutions-for-chapter-4.html#cb38-3" aria-hidden="true" tabindex="-1"></a>samples_N <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb38-4"><a href="solutions-for-chapter-4.html#cb38-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(samples_N, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb38-5"><a href="solutions-for-chapter-4.html#cb38-5" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">rexp</span>(samples_N, <span class="dv">1</span>)</span>
<span id="cb38-6"><a href="solutions-for-chapter-4.html#cb38-6" aria-hidden="true" tabindex="-1"></a>y_sim <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(samples_N, mu, sigma)</span>
<span id="cb38-7"><a href="solutions-for-chapter-4.html#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="solutions-for-chapter-4.html#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x=</span>y_sim)) <span class="sc">+</span> </span>
<span id="cb38-9"><a href="solutions-for-chapter-4.html#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>) <span class="sc">+</span> </span>
<span id="cb38-10"><a href="solutions-for-chapter-4.html#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Simulated Y&quot;</span>)</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/4M1-1.png" width="672" /></p>
</div>
<div id="m2-2" class="section level4 unnumbered">
<h4>4M2</h4>
<p>Translate the model just above into a quap formula.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="solutions-for-chapter-4.html#cb39-1" aria-hidden="true" tabindex="-1"></a>quap_formula <span class="ot">&lt;-</span> <span class="fu">alist</span>(</span>
<span id="cb39-2"><a href="solutions-for-chapter-4.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb39-3"><a href="solutions-for-chapter-4.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  mu <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb39-4"><a href="solutions-for-chapter-4.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="m3-2" class="section level4 unnumbered">
<h4>4M3</h4>
<p>Translate the quap model formula below into a mathematical model definition.</p>
<pre><code>y ~ dnorm( mu , sigma ),
mu &lt;- a + b*x,
a ~ dnorm( 0 , 10 ),
b ~ dunif( 0 , 1 ),
sigma ~ dexp( 1 )</code></pre>
<p><span class="math display">\[y_i â¼ Normal(\mu, \sigma) \\
\mu_i = \alpha + \beta x_i \\
Î± â¼ Normal(0, 10) \\ 
Î² â¼ Uniform(0, 1) \\
Ï â¼ Exponential(1)\]</span></p>
</div>
<div id="m4-2" class="section level4 unnumbered">
<h4>4M4</h4>
<p>A sample of students is measured for height each year for 3 years. After the third year, you want to fit a linear regression predicting height using year as a predictor. Write down the mathematical model definition for this regression, using any variable names and priors you choose. Be prepared to defend your choice of priors.</p>
<p>I assume <em>students</em> as in <em>college students</em>. Therefore, you would expect an adult height, may be slightly lower, hence <code>170</code> for the intercept. You donât expect them to grow much, hence conservative slope for the effect of the year. I assume a fairly broad but strictly positive prior for <span class="math inline">\(\sigma\)</span>.</p>
<p><span class="math display">\[h_i â¼ Normal(\mu, \sigma) \\
\mu_i = \alpha + \beta year_i \\
Î± â¼ Normal(170, 10) \\ 
Î² â¼ Normal(0, 1) \\
Ï â¼ Exponential(0.1)\]</span></p>
</div>
<div id="m5-2" class="section level4 unnumbered">
<h4>4M5</h4>
<p>Now suppose I remind you that every student got taller each year. Does this information lead you to change your choice of priors? How?</p>
<p>I would ensure that <span class="math inline">\(\beta\)</span> can be only positive, so <span class="math inline">\(Î² â¼ Exponential(1)\)</span>.</p>
</div>
<div id="m6-2" class="section level4 unnumbered">
<h4>4M6</h4>
<p>Now suppose I tell you that the variance among heights for students of the same age is never more than 64cm. How does this lead you to revise your priors?</p>
<p>Based on the density plot, I would pick a more conservative prior of <span class="math inline">\(\sigma \sim Exponential(0.5)\)</span> that drops off more rapidly and just barely includes <span class="math inline">\(\sqrt(64)\)</span>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="solutions-for-chapter-4.html#cb41-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb41-2"><a href="solutions-for-chapter-4.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span> <span class="fu">dexp</span>(x, <span class="fl">0.5</span>))) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="solutions-for-chapter-4.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb41-4"><a href="solutions-for-chapter-4.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="solutions-for-chapter-4.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Probability density&quot;</span>)</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="m7-1" class="section level4 unnumbered">
<h4>4M7</h4>
<p>Refit model m4.3 from the chapter, but omit the mean weight xbar this time. Compare the new modelâs posterior to that of the original model. In particular, look at the covariance among the parameters. What is different? Then compare the posterior predictions of both models.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="solutions-for-chapter-4.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load data again, since it&#39;s a long way back</span></span>
<span id="cb42-2"><a href="solutions-for-chapter-4.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb42-3"><a href="solutions-for-chapter-4.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Howell1); </span>
<span id="cb42-4"><a href="solutions-for-chapter-4.html#cb42-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Howell1; </span>
<span id="cb42-5"><a href="solutions-for-chapter-4.html#cb42-5" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[d<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">18</span>,]</span>
<span id="cb42-6"><a href="solutions-for-chapter-4.html#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="solutions-for-chapter-4.html#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># define the average weight, x-bar</span></span>
<span id="cb42-8"><a href="solutions-for-chapter-4.html#cb42-8" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb42-9"><a href="solutions-for-chapter-4.html#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb42-10"><a href="solutions-for-chapter-4.html#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="solutions-for-chapter-4.html#cb42-11" aria-hidden="true" tabindex="-1"></a>m4_3c <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb42-12"><a href="solutions-for-chapter-4.html#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb42-13"><a href="solutions-for-chapter-4.html#cb42-13" aria-hidden="true" tabindex="-1"></a>    height <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb42-14"><a href="solutions-for-chapter-4.html#cb42-14" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> (weight <span class="sc">-</span> xbar),</span>
<span id="cb42-15"><a href="solutions-for-chapter-4.html#cb42-15" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">178</span>, <span class="dv">20</span>) ,</span>
<span id="cb42-16"><a href="solutions-for-chapter-4.html#cb42-16" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>) ,</span>
<span id="cb42-17"><a href="solutions-for-chapter-4.html#cb42-17" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)) , </span>
<span id="cb42-18"><a href="solutions-for-chapter-4.html#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>d2)</span>
<span id="cb42-19"><a href="solutions-for-chapter-4.html#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="solutions-for-chapter-4.html#cb42-20" aria-hidden="true" tabindex="-1"></a>m4_3 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb42-21"><a href="solutions-for-chapter-4.html#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb42-22"><a href="solutions-for-chapter-4.html#cb42-22" aria-hidden="true" tabindex="-1"></a>    height <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb42-23"><a href="solutions-for-chapter-4.html#cb42-23" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> weight,</span>
<span id="cb42-24"><a href="solutions-for-chapter-4.html#cb42-24" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">178</span>, <span class="dv">20</span>) ,</span>
<span id="cb42-25"><a href="solutions-for-chapter-4.html#cb42-25" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>) ,</span>
<span id="cb42-26"><a href="solutions-for-chapter-4.html#cb42-26" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)) , </span>
<span id="cb42-27"><a href="solutions-for-chapter-4.html#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>d2)</span>
<span id="cb42-28"><a href="solutions-for-chapter-4.html#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="solutions-for-chapter-4.html#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m4_3)</span></code></pre></div>
<pre><code>##              mean         sd        5.5%       94.5%
## a     114.5342008 1.89774719 111.5012343 117.5671674
## b       0.8907326 0.04175799   0.8239952   0.9574699
## sigma   5.0727190 0.19124895   4.7670662   5.3783718</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="solutions-for-chapter-4.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m4_3c)</span></code></pre></div>
<pre><code>##              mean         sd        5.5%      94.5%
## a     154.6013683 0.27030768 154.1693645 155.033372
## b       0.9032809 0.04192363   0.8362788   0.970283
## sigma   5.0718813 0.19115482   4.7663790   5.377384</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="solutions-for-chapter-4.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vcov</span>(m4_3), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##            a      b sigma
## a      3.601 -0.078 0.009
## b     -0.078  0.002 0.000
## sigma  0.009  0.000 0.037</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="solutions-for-chapter-4.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">vcov</span>(m4_3c), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##           a     b sigma
## a     0.073 0.000 0.000
## b     0.000 0.002 0.000
## sigma 0.000 0.000 0.037</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="solutions-for-chapter-4.html#cb50-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m4_3)</span>
<span id="cb50-2"><a href="solutions-for-chapter-4.html#cb50-2" aria-hidden="true" tabindex="-1"></a>a_map <span class="ot">&lt;-</span> <span class="fu">mean</span>(post<span class="sc">$</span>a)</span>
<span id="cb50-3"><a href="solutions-for-chapter-4.html#cb50-3" aria-hidden="true" tabindex="-1"></a>b_map <span class="ot">&lt;-</span> <span class="fu">mean</span>(post<span class="sc">$</span>b)</span>
<span id="cb50-4"><a href="solutions-for-chapter-4.html#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="solutions-for-chapter-4.html#cb50-5" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> d2<span class="sc">$</span>weight</span>
<span id="cb50-6"><a href="solutions-for-chapter-4.html#cb50-6" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> a_map <span class="sc">+</span> b_map<span class="sc">*</span>w</span>
<span id="cb50-7"><a href="solutions-for-chapter-4.html#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="solutions-for-chapter-4.html#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d2, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>height)) <span class="sc">+</span> </span>
<span id="cb50-9"><a href="solutions-for-chapter-4.html#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-10"><a href="solutions-for-chapter-4.html#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x=</span>w, <span class="at">y=</span>prediction))</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/4M7-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="solutions-for-chapter-4.html#cb51-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m4_3c)</span>
<span id="cb51-2"><a href="solutions-for-chapter-4.html#cb51-2" aria-hidden="true" tabindex="-1"></a>a_map <span class="ot">&lt;-</span> <span class="fu">mean</span>(post<span class="sc">$</span>a)</span>
<span id="cb51-3"><a href="solutions-for-chapter-4.html#cb51-3" aria-hidden="true" tabindex="-1"></a>b_map <span class="ot">&lt;-</span> <span class="fu">mean</span>(post<span class="sc">$</span>b)</span>
<span id="cb51-4"><a href="solutions-for-chapter-4.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="solutions-for-chapter-4.html#cb51-5" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> d2<span class="sc">$</span>weight</span>
<span id="cb51-6"><a href="solutions-for-chapter-4.html#cb51-6" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> a_map <span class="sc">+</span> b_map<span class="sc">*</span>(w <span class="sc">-</span> xbar)</span>
<span id="cb51-7"><a href="solutions-for-chapter-4.html#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="solutions-for-chapter-4.html#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d2, <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">y=</span>height)) <span class="sc">+</span> </span>
<span id="cb51-9"><a href="solutions-for-chapter-4.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="solutions-for-chapter-4.html#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x=</span>w, <span class="at">y=</span>prediction))</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="m8" class="section level4 unnumbered">
<h4>4M8</h4>
<p>In the chapter, we used 15 knots with the cherry blossom spline. Increase the number of knots and observe what happens to the resulting spline. Then adjust also the width of the prior on the weightsâchange the standard deviation of the prior and watch what happens. What do you think the combination of knot number and the prior on the weights controls?</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="solutions-for-chapter-4.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cherry_blossoms)</span>
<span id="cb52-2"><a href="solutions-for-chapter-4.html#cb52-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> cherry_blossoms</span>
<span id="cb52-3"><a href="solutions-for-chapter-4.html#cb52-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[ <span class="fu">complete.cases</span>(d<span class="sc">$</span>doy) , ] <span class="co"># complete cases on doy</span></span>
<span id="cb52-4"><a href="solutions-for-chapter-4.html#cb52-4" aria-hidden="true" tabindex="-1"></a>num_knots <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb52-5"><a href="solutions-for-chapter-4.html#cb52-5" aria-hidden="true" tabindex="-1"></a>knot_list <span class="ot">&lt;-</span> <span class="fu">quantile</span>( d2<span class="sc">$</span>year , <span class="at">probs=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span>num_knots) )</span>
<span id="cb52-6"><a href="solutions-for-chapter-4.html#cb52-6" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">bs</span>(d2<span class="sc">$</span>year,</span>
<span id="cb52-7"><a href="solutions-for-chapter-4.html#cb52-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">knots=</span>knot_list[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,num_knots)],</span>
<span id="cb52-8"><a href="solutions-for-chapter-4.html#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">degree=</span><span class="dv">3</span> , <span class="at">intercept=</span><span class="cn">TRUE</span>)</span>
<span id="cb52-9"><a href="solutions-for-chapter-4.html#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="solutions-for-chapter-4.html#cb52-10" aria-hidden="true" tabindex="-1"></a>m4<span class="fl">.7</span>_30 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb52-11"><a href="solutions-for-chapter-4.html#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb52-12"><a href="solutions-for-chapter-4.html#cb52-12" aria-hidden="true" tabindex="-1"></a>    D <span class="sc">~</span> <span class="fu">dnorm</span>( mu , sigma ) ,</span>
<span id="cb52-13"><a href="solutions-for-chapter-4.html#cb52-13" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> B <span class="sc">%*%</span> w ,</span>
<span id="cb52-14"><a href="solutions-for-chapter-4.html#cb52-14" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">100</span>,<span class="dv">10</span>),</span>
<span id="cb52-15"><a href="solutions-for-chapter-4.html#cb52-15" aria-hidden="true" tabindex="-1"></a>    w <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb52-16"><a href="solutions-for-chapter-4.html#cb52-16" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)), </span>
<span id="cb52-17"><a href="solutions-for-chapter-4.html#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span><span class="fu">list</span>(<span class="at">D=</span>d2<span class="sc">$</span>doy, <span class="at">B=</span>B) ,</span>
<span id="cb52-18"><a href="solutions-for-chapter-4.html#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">start=</span><span class="fu">list</span>(<span class="at">w=</span><span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(B))))</span>
<span id="cb52-19"><a href="solutions-for-chapter-4.html#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="solutions-for-chapter-4.html#cb52-20" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">link</span>( m4<span class="fl">.7</span>_30 )</span>
<span id="cb52-21"><a href="solutions-for-chapter-4.html#cb52-21" aria-hidden="true" tabindex="-1"></a>mu_PI <span class="ot">&lt;-</span> <span class="fu">apply</span>(mu,<span class="dv">2</span>, PI, <span class="fl">0.97</span>)</span>
<span id="cb52-22"><a href="solutions-for-chapter-4.html#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( d2<span class="sc">$</span>year , d2<span class="sc">$</span>doy , <span class="at">col=</span><span class="fu">col.alpha</span>(rangi2,<span class="fl">0.3</span>) , <span class="at">pch=</span><span class="dv">16</span> )</span>
<span id="cb52-23"><a href="solutions-for-chapter-4.html#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="fu">shade</span>( mu_PI , d2<span class="sc">$</span>year , <span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.5</span>) )</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/4M8-1.png" width="672" />
<strong>Together, they control just how wiggly vs.Â smooth the resultant curve is.</strong></p>
</div>
<div id="h1-2" class="section level4 unnumbered">
<h4>4H1</h4>
<p>The weights listed below were recorded in the !Kung census, but heights were not recorded for these individuals. Provide predicted heights and 89% intervals for each of these individuals. That is, fill in the table below, using model-based predictions.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="solutions-for-chapter-4.html#cb53-1" aria-hidden="true" tabindex="-1"></a>predicted_weight <span class="ot">&lt;-</span> </span>
<span id="cb53-2"><a href="solutions-for-chapter-4.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Individual =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb53-3"><a href="solutions-for-chapter-4.html#cb53-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">weight =</span> <span class="fu">c</span>(<span class="fl">46.95</span>, <span class="fl">43.72</span>, <span class="fl">64.78</span>, <span class="fl">32.59</span>, <span class="fl">54.63</span>))</span>
<span id="cb53-4"><a href="solutions-for-chapter-4.html#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="solutions-for-chapter-4.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># getting sampled means</span></span>
<span id="cb53-6"><a href="solutions-for-chapter-4.html#cb53-6" aria-hidden="true" tabindex="-1"></a>posterior_mu <span class="ot">&lt;-</span> <span class="fu">link</span>(m4_3c, <span class="at">data=</span>predicted_weight)</span>
<span id="cb53-7"><a href="solutions-for-chapter-4.html#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="solutions-for-chapter-4.html#cb53-8" aria-hidden="true" tabindex="-1"></a>predicted_weight <span class="ot">&lt;-</span> predicted_weight <span class="sc">%&gt;%</span></span>
<span id="cb53-9"><a href="solutions-for-chapter-4.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">expected height</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">apply</span>(posterior_mu, <span class="dv">2</span>, mean), </span>
<span id="cb53-10"><a href="solutions-for-chapter-4.html#cb53-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">LowerCI =</span> <span class="fu">round</span>(<span class="fu">apply</span>(posterior_mu, <span class="dv">2</span>, quantile, <span class="at">probs=</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="dv">2</span>),</span>
<span id="cb53-11"><a href="solutions-for-chapter-4.html#cb53-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">UpperCI =</span> <span class="fu">round</span>(<span class="fu">apply</span>(posterior_mu, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="dv">2</span>),</span>
<span id="cb53-12"><a href="solutions-for-chapter-4.html#cb53-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">89% interval</span><span class="st">`</span> <span class="ot">=</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;{LowerCI}..{UpperCI}&quot;</span>))  <span class="sc">%&gt;%</span></span>
<span id="cb53-13"><a href="solutions-for-chapter-4.html#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>LowerCI, <span class="sc">-</span>UpperCI)</span>
<span id="cb53-14"><a href="solutions-for-chapter-4.html#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="solutions-for-chapter-4.html#cb53-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(predicted_weight)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Individual</th>
<th align="right">weight</th>
<th align="right">expected height</th>
<th align="left">89% interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">46.95</td>
<td align="right">156.3876</td>
<td align="left">155.97..156.83</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">43.72</td>
<td align="right">153.4682</td>
<td align="left">153.05..153.89</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">64.78</td>
<td align="right">172.5032</td>
<td align="left">171.1..173.91</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">32.59</td>
<td align="right">143.4083</td>
<td align="left">142.5..144.37</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">54.63</td>
<td align="right">163.3292</td>
<td align="left">162.57..164.07</td>
</tr>
</tbody>
</table>
</div>
<div id="h2-2" class="section level4 unnumbered">
<h4>4H2</h4>
<p>Select out all the rows in the Howell1 data with ages below 18 years of age. If you do it right, you should end up with a new data frame with 192 rows in it.</p>
<ol style="list-style-type: lower-alpha">
<li>Fit a linear regression to these data, using quap. Present and interpret the estimates. For
every 10 units of increase in weight, how much taller does the model predict a child gets?</li>
</ol>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="solutions-for-chapter-4.html#cb54-1" aria-hidden="true" tabindex="-1"></a>kung_kids <span class="ot">&lt;-</span> <span class="fu">filter</span>(Howell1, age <span class="sc">&lt;</span> <span class="dv">18</span>)</span>
<span id="cb54-2"><a href="solutions-for-chapter-4.html#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="solutions-for-chapter-4.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># define the average weight, x-bar</span></span>
<span id="cb54-4"><a href="solutions-for-chapter-4.html#cb54-4" aria-hidden="true" tabindex="-1"></a>avg_kid_weight <span class="ot">&lt;-</span> <span class="fu">mean</span>(kung_kids<span class="sc">$</span>weight)</span>
<span id="cb54-5"><a href="solutions-for-chapter-4.html#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="solutions-for-chapter-4.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb54-7"><a href="solutions-for-chapter-4.html#cb54-7" aria-hidden="true" tabindex="-1"></a>kung_kids_fit <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb54-8"><a href="solutions-for-chapter-4.html#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb54-9"><a href="solutions-for-chapter-4.html#cb54-9" aria-hidden="true" tabindex="-1"></a>    height <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb54-10"><a href="solutions-for-chapter-4.html#cb54-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> (weight <span class="sc">-</span> avg_kid_weight),</span>
<span id="cb54-11"><a href="solutions-for-chapter-4.html#cb54-11" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">140</span>, <span class="dv">20</span>) ,</span>
<span id="cb54-12"><a href="solutions-for-chapter-4.html#cb54-12" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>) ,</span>
<span id="cb54-13"><a href="solutions-for-chapter-4.html#cb54-13" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)) , </span>
<span id="cb54-14"><a href="solutions-for-chapter-4.html#cb54-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>kung_kids)</span>
<span id="cb54-15"><a href="solutions-for-chapter-4.html#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="solutions-for-chapter-4.html#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(kung_kids_fit)</span></code></pre></div>
<pre><code>##             mean         sd       5.5%      94.5%
## a     108.348193 0.60862837 107.375488 109.320899
## b       2.716657 0.06831574   2.607475   2.825839
## sigma   8.437208 0.43057023   7.749073   9.125342</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="solutions-for-chapter-4.html#cb56-1" aria-hidden="true" tabindex="-1"></a>b_mean <span class="ot">&lt;-</span> <span class="fu">precis</span>(kung_kids_fit)[<span class="st">&#39;b&#39;</span>, <span class="st">&#39;mean&#39;</span>]</span></code></pre></div>
<p><strong>For every 10 units of increase in weight, the model predict a child will get 27.2 cm taller.</strong></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Plot the raw data, with height on the vertical axis and weight on the horizontal axis. Superimpose the MAP regression line and 89% interval for the mean. Also superimpose the 89% interval for predicted heights.</li>
</ol>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="solutions-for-chapter-4.html#cb57-1" aria-hidden="true" tabindex="-1"></a>mean_estimates <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">weight =</span> <span class="fu">seq</span>(<span class="fu">min</span>(kung_kids<span class="sc">$</span>weight), <span class="fu">max</span>(kung_kids<span class="sc">$</span>weight), <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb57-2"><a href="solutions-for-chapter-4.html#cb57-2" aria-hidden="true" tabindex="-1"></a>sample_means <span class="ot">&lt;-</span> <span class="fu">link</span>(kung_kids_fit, mean_estimates)</span>
<span id="cb57-3"><a href="solutions-for-chapter-4.html#cb57-3" aria-hidden="true" tabindex="-1"></a>mean_estimates <span class="ot">&lt;-</span></span>
<span id="cb57-4"><a href="solutions-for-chapter-4.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  mean_estimates <span class="sc">%&gt;%</span></span>
<span id="cb57-5"><a href="solutions-for-chapter-4.html#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, mean),</span>
<span id="cb57-6"><a href="solutions-for-chapter-4.html#cb57-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">lowerCI =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, quantile, <span class="at">probs=</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb57-7"><a href="solutions-for-chapter-4.html#cb57-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">upperCI =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb57-8"><a href="solutions-for-chapter-4.html#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="solutions-for-chapter-4.html#cb57-9" aria-hidden="true" tabindex="-1"></a>simulated_height_samples <span class="ot">&lt;-</span> <span class="fu">sim</span>(kung_kids_fit, mean_estimates)</span>
<span id="cb57-10"><a href="solutions-for-chapter-4.html#cb57-10" aria-hidden="true" tabindex="-1"></a>simulated_height <span class="ot">&lt;-</span></span>
<span id="cb57-11"><a href="solutions-for-chapter-4.html#cb57-11" aria-hidden="true" tabindex="-1"></a>  mean_estimates <span class="sc">%&gt;%</span></span>
<span id="cb57-12"><a href="solutions-for-chapter-4.html#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lowerCI =</span> <span class="fu">apply</span>(simulated_height_samples, <span class="dv">2</span>, quantile, <span class="at">probs=</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb57-13"><a href="solutions-for-chapter-4.html#cb57-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">upperCI =</span> <span class="fu">apply</span>(simulated_height_samples, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb57-14"><a href="solutions-for-chapter-4.html#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="solutions-for-chapter-4.html#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="solutions-for-chapter-4.html#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> kung_kids, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y=</span>height)) <span class="sc">+</span> </span>
<span id="cb57-17"><a href="solutions-for-chapter-4.html#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>simulated_height, <span class="fu">aes</span>(<span class="at">y=</span>lowerCI, <span class="at">ymin=</span>lowerCI, <span class="at">ymax=</span>upperCI), <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb57-18"><a href="solutions-for-chapter-4.html#cb57-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>mean_estimates, <span class="fu">aes</span>(<span class="at">y=</span>mu, <span class="at">ymin=</span>lowerCI, <span class="at">ymax=</span>upperCI), <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb57-19"><a href="solutions-for-chapter-4.html#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb57-20"><a href="solutions-for-chapter-4.html#cb57-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>mean_estimates, <span class="fu">aes</span>(<span class="at">y=</span>mu))</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/4H2b-1.png" width="672" /></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>What aspects of the model fit concern you? Describe the kinds of assumptions you would
change, if any, to improve the model. You donât have to write any new code. Just explain what the
model appears to be doing a bad job of, and what you hypothesize would be a better model.</li>
</ol>
<p><strong>The relationship is clearly no linear with rapid growth for smaller children turning into a more slow one for older ones.</strong></p>
</div>
<div id="h3-2" class="section level4 unnumbered">
<h4>4H3</h4>
<p>Suppose a colleague of yours, who works on allometry, glances at the practice problems just above. Your colleague exclaims, âThatâs silly. Everyone knows that itâs only the logarithm of body weight that scales with height!â Letâs take your colleagueâs advice and see what happens.</p>
<ol style="list-style-type: lower-alpha">
<li>Model the relationship between height (cm) and the natural logarithm of weight (log-kg). Use the entire Howell1 data frame, all 544 rows, adults and non-adults. Can you interpret the resulting estimates?</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="solutions-for-chapter-4.html#cb58-1" aria-hidden="true" tabindex="-1"></a>kung <span class="ot">&lt;-</span> </span>
<span id="cb58-2"><a href="solutions-for-chapter-4.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  Howell1 <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="solutions-for-chapter-4.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logWeight =</span> <span class="fu">log</span>(weight))</span>
<span id="cb58-4"><a href="solutions-for-chapter-4.html#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="solutions-for-chapter-4.html#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define the average weight, x-bar</span></span>
<span id="cb58-6"><a href="solutions-for-chapter-4.html#cb58-6" aria-hidden="true" tabindex="-1"></a>avg_log_weight <span class="ot">&lt;-</span> <span class="fu">mean</span>(kung<span class="sc">$</span>logWeight)</span>
<span id="cb58-7"><a href="solutions-for-chapter-4.html#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="solutions-for-chapter-4.html#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb58-9"><a href="solutions-for-chapter-4.html#cb58-9" aria-hidden="true" tabindex="-1"></a>kung_fit <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb58-10"><a href="solutions-for-chapter-4.html#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb58-11"><a href="solutions-for-chapter-4.html#cb58-11" aria-hidden="true" tabindex="-1"></a>    height <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb58-12"><a href="solutions-for-chapter-4.html#cb58-12" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> (logWeight <span class="sc">-</span> avg_log_weight),</span>
<span id="cb58-13"><a href="solutions-for-chapter-4.html#cb58-13" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">140</span>, <span class="dv">20</span>) ,</span>
<span id="cb58-14"><a href="solutions-for-chapter-4.html#cb58-14" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dlnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>) ,</span>
<span id="cb58-15"><a href="solutions-for-chapter-4.html#cb58-15" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)) , </span>
<span id="cb58-16"><a href="solutions-for-chapter-4.html#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>kung)</span>
<span id="cb58-17"><a href="solutions-for-chapter-4.html#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="solutions-for-chapter-4.html#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(kung_fit)</span></code></pre></div>
<pre><code>##             mean        sd       5.5%      94.5%
## a     138.263717 0.2201177 137.911927 138.615508
## b      47.072415 0.3826000  46.460947  47.683884
## sigma   5.134294 0.1556374   4.885555   5.383032</code></pre>
<p><strong>Not really, as <code>b</code> now refers to change in height in response to 1 log-Kg of weight.</strong></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Begin with this plot: plot( height ~ weight , data=Howell1 ). Then use samples from the quadratic approximate posterior of the model in (a) to superimpose on the plot:
<ol style="list-style-type: decimal">
<li>the predicted mean height as a function of weight,</li>
<li>the 97% interval for the mean, and</li>
<li>the 97% interval for predicted heights.</li>
</ol></li>
</ol>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="solutions-for-chapter-4.html#cb60-1" aria-hidden="true" tabindex="-1"></a>mean_estimates <span class="ot">&lt;-</span> </span>
<span id="cb60-2"><a href="solutions-for-chapter-4.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">weight =</span> <span class="fu">seq</span>(<span class="fu">min</span>(kung<span class="sc">$</span>weight), <span class="fu">max</span>(kung<span class="sc">$</span>weight), <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="solutions-for-chapter-4.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logWeight =</span> <span class="fu">log</span>(weight))</span>
<span id="cb60-4"><a href="solutions-for-chapter-4.html#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="solutions-for-chapter-4.html#cb60-5" aria-hidden="true" tabindex="-1"></a>sample_means <span class="ot">&lt;-</span> <span class="fu">link</span>(kung_fit, mean_estimates)</span>
<span id="cb60-6"><a href="solutions-for-chapter-4.html#cb60-6" aria-hidden="true" tabindex="-1"></a>mean_estimates <span class="ot">&lt;-</span></span>
<span id="cb60-7"><a href="solutions-for-chapter-4.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  mean_estimates <span class="sc">%&gt;%</span></span>
<span id="cb60-8"><a href="solutions-for-chapter-4.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, mean),</span>
<span id="cb60-9"><a href="solutions-for-chapter-4.html#cb60-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">lowerCI =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, quantile, <span class="at">probs=</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb60-10"><a href="solutions-for-chapter-4.html#cb60-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">upperCI =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb60-11"><a href="solutions-for-chapter-4.html#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="solutions-for-chapter-4.html#cb60-12" aria-hidden="true" tabindex="-1"></a>simulated_height_samples <span class="ot">&lt;-</span> <span class="fu">sim</span>(kung_fit, mean_estimates)</span>
<span id="cb60-13"><a href="solutions-for-chapter-4.html#cb60-13" aria-hidden="true" tabindex="-1"></a>simulated_height <span class="ot">&lt;-</span></span>
<span id="cb60-14"><a href="solutions-for-chapter-4.html#cb60-14" aria-hidden="true" tabindex="-1"></a>  mean_estimates <span class="sc">%&gt;%</span></span>
<span id="cb60-15"><a href="solutions-for-chapter-4.html#cb60-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lowerCI =</span> <span class="fu">apply</span>(simulated_height_samples, <span class="dv">2</span>, quantile, <span class="at">probs=</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb60-16"><a href="solutions-for-chapter-4.html#cb60-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">upperCI =</span> <span class="fu">apply</span>(simulated_height_samples, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb60-17"><a href="solutions-for-chapter-4.html#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="solutions-for-chapter-4.html#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="solutions-for-chapter-4.html#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> kung, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y=</span>height)) <span class="sc">+</span> </span>
<span id="cb60-20"><a href="solutions-for-chapter-4.html#cb60-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>simulated_height, <span class="fu">aes</span>(<span class="at">y=</span>lowerCI, <span class="at">ymin=</span>lowerCI, <span class="at">ymax=</span>upperCI), <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb60-21"><a href="solutions-for-chapter-4.html#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>mean_estimates, <span class="fu">aes</span>(<span class="at">y=</span>mu, <span class="at">ymin=</span>lowerCI, <span class="at">ymax=</span>upperCI), <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-22"><a href="solutions-for-chapter-4.html#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb60-23"><a href="solutions-for-chapter-4.html#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>mean_estimates, <span class="fu">aes</span>(<span class="at">y=</span>mu))</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/4H3b-1.png" width="672" /></p>
</div>
<div id="h4-2" class="section level4 unnumbered">
<h4>4H4</h4>
<p>Plot the prior predictive distribution for the parabolic polynomial regression model in the chapter. You can modify the code that plots the linear regression prior predictive distribution. Can you modify the prior distributions of Î±, Î²1, and Î²2 so that the prior predictions stay within the biologically reasonable outcome space? That is to say: Do not try to fit the data by hand. But do try to keep the curves consistent with what you know about height and weight, before seeing these exact data.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="solutions-for-chapter-4.html#cb61-1" aria-hidden="true" tabindex="-1"></a>zWeight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">scale</span>(kung<span class="sc">$</span>weight))</span>
<span id="cb61-2"><a href="solutions-for-chapter-4.html#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="solutions-for-chapter-4.html#cb61-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb61-4"><a href="solutions-for-chapter-4.html#cb61-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">100</span>, <span class="dv">20</span>)</span>
<span id="cb61-5"><a href="solutions-for-chapter-4.html#cb61-5" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(N, <span class="fl">2.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb61-6"><a href="solutions-for-chapter-4.html#cb61-6" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb61-7"><a href="solutions-for-chapter-4.html#cb61-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> zWeight</span>
<span id="cb61-8"><a href="solutions-for-chapter-4.html#cb61-8" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> zWeight<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb61-9"><a href="solutions-for-chapter-4.html#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span>, <span class="at">xlim=</span><span class="fu">range</span>(zWeight), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">300</span>),</span>
<span id="cb61-10"><a href="solutions-for-chapter-4.html#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;zWeight&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;height&quot;</span>)</span>
<span id="cb61-11"><a href="solutions-for-chapter-4.html#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="solutions-for-chapter-4.html#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb61-13"><a href="solutions-for-chapter-4.html#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>( a[i] <span class="sc">+</span> b1[i]<span class="sc">*</span>x <span class="sc">+</span> b2[i]<span class="sc">*</span>(x<span class="sc">*</span>x),</span>
<span id="cb61-14"><a href="solutions-for-chapter-4.html#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">from=</span><span class="fu">min</span>(zWeight), <span class="at">to=</span><span class="fu">max</span>(zWeight), </span>
<span id="cb61-15"><a href="solutions-for-chapter-4.html#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">add=</span><span class="cn">TRUE</span>,</span>
<span id="cb61-16"><a href="solutions-for-chapter-4.html#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">col.alpha</span>(<span class="st">&quot;black&quot;</span>,<span class="fl">0.2</span>))</span>
<span id="cb61-17"><a href="solutions-for-chapter-4.html#cb61-17" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/4H4-1.png" width="672" /></p>
</div>
<div id="h5-1" class="section level4 unnumbered">
<h4>4H5</h4>
<p>Return to data(cherry_blossoms) and model the association between blossom date (doy) and March temperature (temp). Note that there are many missing values in both variables. You may consider a linear model, a polynomial, or a spline on temperature. How well does temperature trend predict the blossom trend?</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="solutions-for-chapter-4.html#cb62-1" aria-hidden="true" tabindex="-1"></a>sakura <span class="ot">&lt;-</span> </span>
<span id="cb62-2"><a href="solutions-for-chapter-4.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  cherry_blossoms <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="solutions-for-chapter-4.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(doy, temp)</span>
<span id="cb62-4"><a href="solutions-for-chapter-4.html#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="solutions-for-chapter-4.html#cb62-5" aria-hidden="true" tabindex="-1"></a>avg_temp <span class="ot">&lt;-</span> <span class="fu">mean</span>(sakura<span class="sc">$</span>temp)</span>
<span id="cb62-6"><a href="solutions-for-chapter-4.html#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="solutions-for-chapter-4.html#cb62-7" aria-hidden="true" tabindex="-1"></a>sakura_fit <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb62-8"><a href="solutions-for-chapter-4.html#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alist</span>(</span>
<span id="cb62-9"><a href="solutions-for-chapter-4.html#cb62-9" aria-hidden="true" tabindex="-1"></a>    doy <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb62-10"><a href="solutions-for-chapter-4.html#cb62-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> a <span class="sc">+</span> b <span class="sc">*</span> (temp <span class="sc">-</span> avg_temp),</span>
<span id="cb62-11"><a href="solutions-for-chapter-4.html#cb62-11" aria-hidden="true" tabindex="-1"></a>    a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">75</span>, <span class="dv">30</span>), <span class="co"># jan-may is about 150 days, so 75Â±60 is very conservative spring estimate</span></span>
<span id="cb62-12"><a href="solutions-for-chapter-4.html#cb62-12" aria-hidden="true" tabindex="-1"></a>    b <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="co"># we would assume the relationship to be negative, so higher tempratures leading to sooner blooming</span></span>
<span id="cb62-13"><a href="solutions-for-chapter-4.html#cb62-13" aria-hidden="true" tabindex="-1"></a>    sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">15</span>)), <span class="co"># Â±30 gives us a month</span></span>
<span id="cb62-14"><a href="solutions-for-chapter-4.html#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>sakura)</span>
<span id="cb62-15"><a href="solutions-for-chapter-4.html#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="solutions-for-chapter-4.html#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(sakura_fit)</span></code></pre></div>
<pre><code>##             mean        sd       5.5%      94.5%
## a     104.919743 0.2107589 104.582909 105.256576
## b      -2.733661 0.2951189  -3.205318  -2.262004
## sigma   5.912675 0.1491559   5.674295   6.151055</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="solutions-for-chapter-4.html#cb64-1" aria-hidden="true" tabindex="-1"></a>mean_estimates <span class="ot">&lt;-</span> </span>
<span id="cb64-2"><a href="solutions-for-chapter-4.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">temp =</span> <span class="fu">seq</span>(<span class="fu">min</span>(sakura<span class="sc">$</span>temp), <span class="fu">max</span>(sakura<span class="sc">$</span>temp), <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb64-3"><a href="solutions-for-chapter-4.html#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="solutions-for-chapter-4.html#cb64-4" aria-hidden="true" tabindex="-1"></a>sample_means <span class="ot">&lt;-</span> <span class="fu">link</span>(sakura_fit, mean_estimates)</span>
<span id="cb64-5"><a href="solutions-for-chapter-4.html#cb64-5" aria-hidden="true" tabindex="-1"></a>mean_estimates <span class="ot">&lt;-</span></span>
<span id="cb64-6"><a href="solutions-for-chapter-4.html#cb64-6" aria-hidden="true" tabindex="-1"></a>  mean_estimates <span class="sc">%&gt;%</span></span>
<span id="cb64-7"><a href="solutions-for-chapter-4.html#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, mean),</span>
<span id="cb64-8"><a href="solutions-for-chapter-4.html#cb64-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">lowerCI =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, quantile, <span class="at">probs=</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb64-9"><a href="solutions-for-chapter-4.html#cb64-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">upperCI =</span> <span class="fu">apply</span>(sample_means, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb64-10"><a href="solutions-for-chapter-4.html#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="solutions-for-chapter-4.html#cb64-11" aria-hidden="true" tabindex="-1"></a>simulated_doy_samples <span class="ot">&lt;-</span> <span class="fu">sim</span>(sakura_fit, mean_estimates)</span>
<span id="cb64-12"><a href="solutions-for-chapter-4.html#cb64-12" aria-hidden="true" tabindex="-1"></a>simulated_doy <span class="ot">&lt;-</span></span>
<span id="cb64-13"><a href="solutions-for-chapter-4.html#cb64-13" aria-hidden="true" tabindex="-1"></a>  mean_estimates <span class="sc">%&gt;%</span></span>
<span id="cb64-14"><a href="solutions-for-chapter-4.html#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lowerCI =</span> <span class="fu">apply</span>(simulated_doy_samples, <span class="dv">2</span>, quantile, <span class="at">probs=</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb64-15"><a href="solutions-for-chapter-4.html#cb64-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">upperCI =</span> <span class="fu">apply</span>(simulated_doy_samples, <span class="dv">2</span>, quantile, <span class="at">probs=</span><span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="fl">-0.89</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb64-16"><a href="solutions-for-chapter-4.html#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="solutions-for-chapter-4.html#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sakura, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y=</span>doy)) <span class="sc">+</span> </span>
<span id="cb64-18"><a href="solutions-for-chapter-4.html#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>simulated_doy, <span class="fu">aes</span>(<span class="at">y=</span>lowerCI, <span class="at">ymin=</span>lowerCI, <span class="at">ymax=</span>upperCI), <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb64-19"><a href="solutions-for-chapter-4.html#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>mean_estimates, <span class="fu">aes</span>(<span class="at">y=</span>mu, <span class="at">ymin=</span>lowerCI, <span class="at">ymax=</span>upperCI), <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb64-20"><a href="solutions-for-chapter-4.html#cb64-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb64-21"><a href="solutions-for-chapter-4.html#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>mean_estimates, <span class="fu">aes</span>(<span class="at">y=</span>mu))</span></code></pre></div>
<p><img src="notes-on-statistical-rethinking_files/figure-html/4H5-1.png" width="672" />
<strong>Reasonably well, but you can see a lot of spread in the middle, so other factors are clearly at play.</strong></p>
</div>
<div id="h6" class="section level4 unnumbered">
<h4>4H6</h4>
<p>Simulate the prior predictive distribution for the cherry blossom spline in the chapter. Adjust the prior on the weights and observe what happens. What do you think the prior on the weights is doing?</p>
</div>
<div id="h8" class="section level4 unnumbered">
<h4>4H8</h4>
<p>The cherry blossom spline in the chapter used an intercept Î±, but technically it doesnât require one. The first basis functions could substitute for the intercept. Try refitting the cherry blossom spline without the intercept. What else about the model do you need to change to make this work?</p>

</div>
</div>
















            </section>

          </div>
        </div>
      </div>
<a href="solutions-for-chapter-3.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["notes-on-statistical-rethinking.pdf", "notes-on-statistical-rethinking.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
